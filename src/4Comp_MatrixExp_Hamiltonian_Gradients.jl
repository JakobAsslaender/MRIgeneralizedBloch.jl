function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_m0_C)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, (/)((*)((*)(-1, Rx_C_CFW), T), m0_CFW), 0, (/)((*)(Rx_C_CFW, T), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, (/)((*)((*)((*)(-1, Rx_C_CFW), T), m0_CFW), (^)(m0_C, 2)), 0, (/)((*)((+)((+)((*)(Rx_C_BW, m0_BW), (*)(Rx_C_CFW, m0_CFW)), (*)(Rx_PG_C, m0_PG)), T), (^)(m0_C, 2)), 0, 0, (/)((*)((*)((*)(-1, Rx_C_BW), T), m0_BW), (^)(m0_C, 2)), 0, (/)((*)((*)((*)(-1, Rx_PG_C), T), m0_PG), (^)(m0_C, 2)), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, (/)((*)(Rx_C_BW, T), m0_BW), 0, 0, (/)((*)((*)(-1, Rx_C_BW), T), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, (/)((*)(Rx_PG_C, T), m0_PG), 0, 0, 0, 0, (/)((*)((*)(-1, Rx_PG_C), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, (*)(R1_C, T), 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_m0_PG)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, (/)((*)((*)(-1, Rx_PG_C), T), m0_C), 0, 0, 0, 0, (/)((*)(Rx_PG_C, T), m0_C), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(-1, Rx_BW_PG), T), m0_BW), 0, (/)((*)(Rx_BW_PG, T), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, (/)((*)((*)((*)(-1, Rx_PG_C), T), m0_C), (^)(m0_PG, 2)), 0, 0, (/)((*)((*)((*)(-1, Rx_BW_PG), T), m0_BW), (^)(m0_PG, 2)), 0, (/)((*)((+)((*)(Rx_BW_PG, m0_BW), (*)(Rx_PG_C, m0_C)), T), (^)(m0_PG, 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)(R1_PG, T), 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_m0_BW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, (/)((*)((*)(-1, Rx_CFW_BW), T), m0_CFW), 0, 0, 0, 0, (/)((*)(Rx_CFW_BW, T), m0_CFW), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, (/)((*)((*)(-1, Rx_C_BW), T), m0_C), 0, 0, (/)((*)(Rx_C_BW, T), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, (/)((*)((*)((*)(-1, Rx_CFW_BW), T), m0_CFW), (^)(m0_BW, 2)), 0, (/)((*)((*)((*)(-1, Rx_C_BW), T), m0_C), (^)(m0_BW, 2)), 0, 0, (/)((*)((+)((+)((*)(Rx_BW_PG, m0_PG), (*)(Rx_CFW_BW, m0_CFW)), (*)(Rx_C_BW, m0_C)), T), (^)(m0_BW, 2)), 0, (/)((*)((*)((*)(-1, Rx_BW_PG), T), m0_PG), (^)(m0_BW, 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, (/)((*)(Rx_BW_PG, T), m0_PG), 0, (/)((*)((*)(-1, Rx_BW_PG), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, (*)(R1_BW, T), 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_m0_CFW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, (/)((*)((+)((*)(Rx_CFW_BW, m0_BW), (*)(Rx_C_CFW, m0_C)), T), (^)(m0_CFW, 2)), 0, (/)((*)((*)((*)(-1, Rx_C_CFW), T), m0_C), (^)(m0_CFW, 2)), 0, 0, (/)((*)((*)((*)(-1, Rx_CFW_BW), T), m0_BW), (^)(m0_CFW, 2)), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, (/)((*)(Rx_C_CFW, T), m0_C), 0, (/)((*)((*)(-1, Rx_C_CFW), T), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, (/)((*)(Rx_CFW_BW, T), m0_BW), 0, 0, 0, 0, (/)((*)((*)(-1, Rx_CFW_BW), T), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, (*)(R1_CFW, T), 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_Rx_C_CFW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, (/)((*)(T, (+)((*)(-1, m0_C), (*)(-1, m0_CFW))), m0_CFW), 0, (/)((*)(T, (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, (/)((*)(T, (+)(m0_C, m0_CFW)), m0_C), 0, (/)((*)(T, (+)((*)(-1, m0_C), (*)(-1, m0_CFW))), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_Rx_CFW_BW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, (/)((*)(T, (+)((*)(-1, m0_BW), (*)(-1, m0_CFW))), m0_CFW), 0, 0, 0, 0, (/)((*)(T, (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, (/)((*)(T, (+)(m0_BW, m0_CFW)), m0_BW), 0, 0, 0, 0, (/)((*)(T, (+)((*)(-1, m0_BW), (*)(-1, m0_CFW))), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_Rx_BW_PG)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, (/)((*)(T, (+)((*)(-1, m0_BW), (*)(-1, m0_PG))), m0_BW), 0, (/)((*)(T, (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, (/)((*)(T, (+)(m0_BW, m0_PG)), m0_PG), 0, (/)((*)(T, (+)((*)(-1, m0_BW), (*)(-1, m0_PG))), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_Rx_C_BW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, (/)((*)(T, (+)((*)(-1, m0_BW), (*)(-1, m0_C))), m0_C), 0, 0, (/)((*)(T, (+)(m0_BW, m0_C)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, (/)((*)(T, (+)(m0_BW, m0_C)), m0_BW), 0, 0, (/)((*)(T, (+)((*)(-1, m0_BW), (*)(-1, m0_C))), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_Rx_PG_C)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, (/)((*)(T, (+)((*)(-1, m0_C), (*)(-1, m0_PG))), m0_C), 0, 0, 0, 0, (/)((*)(T, (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, (/)((*)(T, (+)(m0_C, m0_PG)), m0_PG), 0, 0, 0, 0, (/)((*)(T, (+)((*)(-1, m0_C), (*)(-1, m0_PG))), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_R1_C)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, (*)(T, m0_C), 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_R1_PG)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)(T, m0_PG), 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_R1_BW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, (*)(T, m0_BW), 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_R1_CFW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, (*)(T, m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_R2_CFW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_R2_BW)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_T2_C)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), dR2dT2_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_T2_PG)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), dR2dT2_PG), 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_B1)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, (*)(T, ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), dR2dB1_C), (*)((*)(-1, T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, (*)(T, ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, (*)(T, ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), dR2dB1_PG), (*)((*)(-1, T), ω1), 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, (*)(T, ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0_C, m0_PG, m0_BW, m0_CFW, Rx_C_CFW, Rx_CFW_BW, Rx_BW_PG, Rx_C_BW, Rx_PG_C, R1_C, R1_PG, R1_BW, R1_CFW, R2_CFW, R2_BW, R2_C, R2_PG, dR2dT2_C, dR2dB1_C, dR2dT2_PG, dR2dB1_PG, grad_type::grad_ω0)
     @inbounds begin
            begin
                begin
                    SMatrix{21, 21}((*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, T, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, T, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_CFW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_CFW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_CFW), m0_CFW), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), T), m0_CFW), 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_CFW), 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_CFW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_C), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_C_CFW, T), (+)(m0_C, m0_CFW)), m0_C), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_C), m0_C), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_C)), (*)((*)(-1//1, Rx_C_CFW), m0_CFW)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_C), 0, 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_C), 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_C), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_BW), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2_BW), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_CFW_BW, T), (+)(m0_BW, m0_CFW)), m0_BW), 0, (/)((*)((*)(Rx_C_BW, T), (+)(m0_BW, m0_C)), m0_BW), (*)((*)(B1, T), ω1), 0, (/)((*)((+)((+)((+)((+)((+)((+)((*)((*)(-1//1, R1_BW), m0_BW), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_CFW_BW), m0_BW)), (*)((*)(-1//1, Rx_CFW_BW), m0_CFW)), (*)((*)(-1//1, Rx_C_BW), m0_BW)), (*)((*)(-1//1, Rx_C_BW), m0_C)), T), m0_BW), 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_BW), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2_PG), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (/)((*)((*)(Rx_PG_C, T), (+)(m0_C, m0_PG)), m0_PG), 0, 0, (/)((*)((*)(Rx_BW_PG, T), (+)(m0_BW, m0_PG)), m0_PG), (*)((*)(B1, T), ω1), (/)((*)((+)((+)((+)((+)((*)((*)(-1//1, R1_PG), m0_PG), (*)((*)(-1//1, Rx_BW_PG), m0_BW)), (*)((*)(-1//1, Rx_BW_PG), m0_PG)), (*)((*)(-1//1, Rx_PG_C), m0_C)), (*)((*)(-1//1, Rx_PG_C), m0_PG)), T), m0_PG), 0, 0, 0, (*)((*)(R1_CFW, T), m0_CFW), 0, (*)((*)(R1_C, T), m0_C), 0, 0, (*)((*)(R1_BW, T), m0_BW), 0, (*)((*)(R1_PG, T), m0_PG), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
                end
            end
        end
end