function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_m0s)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, (*)((*)(-1, Rex), T), 0, (*)(Rex, T), 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, (*)((*)(-1, Rex), T), 0, (*)(Rex, T), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, (*)((*)(-1, R1f), T), 0, (*)(R1s, T), 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_R1f)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, (*)(T, (+)(1, (*)(-1, m0s))), 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_R2f)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_Rex)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, (*)((*)(-1, T), m0s), 0, (*)(T, m0s), 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, (*)(T, (+)(1, (*)(-1, m0s))), 0, (*)(T, (+)(-1, m0s)), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_R1s)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, 0, 0, (*)(T, m0s), 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_T2s)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, (*)((*)(-1, T), dR2sdT2s), 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_B1)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, (*)((*)(-1, T), ω1), 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), (*)(T, ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, (*)((*)(-1, T), dR2sdB1), (*)((*)(-1, T), ω1), 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)(T, ω1), 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_ω0)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, T, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, 0, 0, 0, 0)
                end
            end
        end
end
function hamiltonian_linear(ω1, B1, ω0, T, m0s, R1f, R2f, Rex, R1s, R2s, dR2sdT2s, dR2sdB1, grad_type::grad_R1a)
     @inbounds begin
            begin
                begin
                    SMatrix{11, 11}((*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, 0, (*)(-1, T), 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2f), T), (*)(T, ω0), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, T), ω0), (*)((*)(-1, R2f), T), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(B1, T), ω1), 0, (*)((+)((*)(-1, R1f), (*)((*)(-1, Rex), m0s)), T), 0, (*)((*)(Rex, T), m0s), 0, 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(-1, R2s), T), (*)((*)((*)(-1, B1), T), ω1), 0, 0, 0, 0, 0, 0, 0, 0, (*)((*)(Rex, T), (+)(1, (*)(-1, m0s))), (*)((*)(B1, T), ω1), (*)((+)((*)(-1, R1s), (*)((*)(-1, Rex), (+)(1, (*)(-1, m0s)))), T), 0, 0, 0, (*)((*)(R1f, T), (+)(1, (*)(-1, m0s))), 0, (*)((*)(R1s, T), m0s), 0, 0, (*)(T, (+)(1, (*)(-1, m0s))), 0, (*)(T, m0s), 0)
                end
            end
        end
end